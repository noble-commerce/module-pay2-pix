<?php

/**
 * DISCLAIMER
 *
 * Do not edit this file if you want to update this module for future new versions.
 *
 * @category Pay2
 * @package Pay2_Pix
 * @copyright Copyright (c) 2022 NobleCommerce
 * @author NobleCommerce <hello@noblecommerce.io>
 *
 * See LICENSE.md for license details.
 */

declare(strict_types=1);

/** @var \Pay2\Pix\Block\Info $block */
/** @var \Magento\Framework\Escaper $escaper */
/** @var \Magento\Framework\View\Helper\SecureHtmlRenderer $secureRenderer */

$storeId = $block->getInfo()->getOrder()->getStoreId();
$specificInfo = $block->getSpecificInformation();
$paymentTitle = $block->getMethod()->getConfigData('title', $storeId);
$qrCodeImage = $block->getInfo()->getAdditionalInformation('qr_code_image');
$qrCodeText = $block->getInfo()->getAdditionalInformation('text_content');
?>
<?= $escaper->escapeHtml($paymentTitle) ?>

<table class="data-table admin__table-secondary">
    <?php foreach ($specificInfo as $label => $value) : ?>
        <tr>
            <th><?= $escaper->escapeHtml($label) ?>:</th>
            <td>
                <?= /* @noEscape */ nl2br($escaper->escapeHtml(implode("\n", $block->getValueAsArray($value, true)))) ?>
            </td>
        </tr>
    <?php endforeach; ?>

    <tr>
        <th scope="row">Status</th>
        <td>
            <?php if ($block->isPaymentPaid()) : ?>
                <?= /* @noEscape */ __('Paid') ?>
            <?php elseif ($block->isPaymentRefunded()) : ?>
                <?= /* @noEscape */ __('Refunded') ?>
            <?php elseif ($block->isPaymentExpired()) : ?>
                <?= /* @noEscape */ __('Expired') ?>
            <?php else : ?>
                <?= /* @noEscape */ __('Waiting') ?>
            <?php endif ?>
        </td>
    </tr>

    <?php if ($block->isPaymentPending()) : ?>
        <!--
        <?php if (!empty($qrCodeImage)) : ?>
        <tr>
            <th scope="row" style="min-width: 120px"><?= /* @noEscape */ __('QR Code') ?></th>
            <td>
                <img style="max-width: 240px; max-height: 240px;" src="<?= /* @noEscape */ $qrCodeImage ?>" alt="<?= /* @noEscape */ __('QR Code') ?>" />
            </td>
        </tr>
        <?php endif ?>
        -->
        <tr>
            <th scope="row" style="min-width: 120px"><?= /* @noEscape */ __('Pix Code') ?></th>
            <td>
                <p style="word-break: break-all;">
                    <?= /* @noEscape */ trim($qrCodeText) ?>
                </p>
            </td>
        </tr>
    <?php endif; ?>
</table>

<?= $block->getChildHtml() ?>
